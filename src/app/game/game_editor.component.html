
<div *ngIf="game">
  <h1>{{game.name}}</h1>
  <h3>id: {{game.id}}</h3>
  <h3>start room: {{game.start_room_id}}</h3>
  <h3>rooms: {{game.room_ids}}</h3>
  <h3>choices: {{game.choice_ids}}</h3>
</div>

<div>
  <form #f="ngForm" (ngSubmit)="onSubmit(f)" ngNativeValidate>
    <button type="submit"> save </button>
    <div class="form-group">
      <label for="name">Game Name</label>
      <input type="text"
        (keyup)="updateGameName(f)"
        id="game-name"
        class="form-contol"
        [ngModel]="game?.name"
        name="name">

    </div>


    <div>
      <form #j="ngForm" (ngSubmit)="addRoom(j)" ngNativeValidate>
        <div class="form-group">
          <label for="name">Room Name</label>
          <input type="text"
                id="room-name"
                class="form-contol"
                [ngModel]="room?.name"
                name="name">
          <label for="description">Room Description</label>
          <input type="text"
                id="room-description"
                class="form-contol"
                [ngModel]="room?.description"
                name="description">

        </div>

        <button type="submit"> add room to game </button>
      </form>
    </div>


    <div fxLayout="row" fxLayoutAlign="start start" fxLayoutGap="15px">
      <div fxLayout="column" fxLayoutAlign="start start" fxLayoutGap="15px">
        <mat-card fxFlex="66" *ngFor="let room of this.rooms; index as i;" class="room-tile">
            <mat-card-header>
              <mat-card-title>
                <h4>
                  index: {{i}}
                  <br>temp_id: {{room.temp_id }},
                  <br>id: {{room.id}},
                  <br> name: {{room.name}},
                  <br> description: {{room.description}},
                  <br> game_id: {{room.game_id}},
                  <br> start room: {{room.is_start_room}},
                  <br> choices: {{room.choice_ids}}
                </h4>
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <form #j="ngForm" ngNativeValidate>
                <div class="form-group">
                  <label for="name">Room Name</label><br>
                  <input type="text"
                        (keyup)="updateRoomAtIndex(j, i)"
                        [ngModel]="room?.name"
                        name="name">
                  <label for="description">Room Description</label><br>
                  <input type="text"
                        (keyup)="updateRoomAtIndex(j, i)"
                        [ngModel]="room?.description"
                        name="description">

                </div>
                <button type="button" name="button" (click)="addChoiceToRoom(room, i)"> add choice to room </button>
                <button type="button" name="button" *ngIf="is_picking_effect_room" (click)="setEffectRoom(room)"> set as effect room </button>
                <button type="button" name="button" (click)="removeRoom(room, i)">delete room</button>
              </form>
              <div class="panel-body" *ngFor="let choice of roomsChoices(room)">
                {{choice.summery}}
                â†’
                {{choiceResultRoomName(choice)}}
                <a *ngIf="!is_picking_effect_room" (click)="pickingEffectRoom(choice)">change result room</a>
              </div>
            </mat-card-content>
        </mat-card>
      </div>


      <div fxLayout="column" fxLayoutAlign="start start" fxLayoutGap="15px">
        <mat-card fxFlex="66" *ngFor="let choice of this.choices; index as i;" class="choice-tile">
            <mat-card-header>
              <mat-card-title>
                <h4>
                  index: {{i}} id: {{choice.id}},
                  <br> temp_id: {{choice.temp_id }},
                  <br> summery: {{choice.summery}},
                  <br> cause room: {{choice.cause_room_id}},
                  <br> effect room: {{choice.effect_room_id}},
                  <br> game: {{choice.game_id}}
                </h4>
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <form #f="ngForm" (ngSubmit)="updatechoiceAtIndex(f, i)" ngNativeValidate>
                <div class="form-group">
                  <label for="name">Choice Summery</label> <br>
                  <input type="text"
                    (keyup)="updatechoiceAtIndex(f, i)"
                    id="choice-summery"
                    class="form-contol"
                    [ngModel]="choice?.summery"
                    name="summery">
                </div>
              </form>
              <button mat-button type="button" (click)="pickingEffectRoom(choice)">pick effect room</button>
              <button mat-button type="button" (click)="removeChoice(choice, i)">delete choice</button>

            </mat-card-content>
        </mat-card>

      </div>

    </div>


    <button type="submit"> save </button>
  </form>
</div>
